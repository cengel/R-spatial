<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 1 Introduction to spatial data in R | Using Spatial Data with R</title>
  <meta name="description" content="Workshop materials for Using Spatial Data with R" />
  <meta name="generator" content="bookdown 0.36 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 1 Introduction to spatial data in R | Using Spatial Data with R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Workshop materials for Using Spatial Data with R" />
  <meta name="github-repo" content="cengel/R-spatial" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 1 Introduction to spatial data in R | Using Spatial Data with R" />
  
  <meta name="twitter:description" content="Workshop materials for Using Spatial Data with R" />
  

<meta name="author" content="Claudia A Engel" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="spatialops.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.2.1/leaflet.js"></script>
<script src="libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.2.1/leaflet-providers-plugin.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Using Spatial Data with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prerequisites and Preparations</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#references"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction to spatial data in R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#the-sf-package"><i class="fa fa-check"></i><b>1.1</b> The <code>sf</code> package</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#creating-a-spatial-object-from-a-latlon-table"><i class="fa fa-check"></i><b>1.2</b> Creating a spatial object from a lat/lon table</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#loading-shape-files-into-r"><i class="fa fa-check"></i><b>1.3</b> Loading shape files into R</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#raster-data-in-r"><i class="fa fa-check"></i><b>1.4</b> Raster data in R</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="spatialops.html"><a href="spatialops.html"><i class="fa fa-check"></i><b>2</b> Spatial data manipulation in R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="spatialops.html"><a href="spatialops.html#attribute-join"><i class="fa fa-check"></i><b>2.1</b> Attribute Join</a></li>
<li class="chapter" data-level="2.2" data-path="spatialops.html"><a href="spatialops.html#topological-subsetting-select-polygons-by-location"><i class="fa fa-check"></i><b>2.2</b> Topological Subsetting: Select Polygons by Location</a></li>
<li class="chapter" data-level="2.3" data-path="spatialops.html"><a href="spatialops.html#reprojecting"><i class="fa fa-check"></i><b>2.3</b> Reprojecting</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="spatialops.html"><a href="spatialops.html#raster-reprojection"><i class="fa fa-check"></i><b>2.3.1</b> Raster reprojection</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="spatialops.html"><a href="spatialops.html#spatial-aggregation-points-in-polygons"><i class="fa fa-check"></i><b>2.4</b> Spatial Aggregation: Points in Polygons</a></li>
<li class="chapter" data-level="2.5" data-path="spatialops.html"><a href="spatialops.html#raster-calculations-with-terra"><i class="fa fa-check"></i><b>2.5</b> Raster calculations with <code>terra</code></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="mapping.html"><a href="mapping.html"><i class="fa fa-check"></i><b>3</b> Making Maps in R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="mapping.html"><a href="mapping.html#choropleth-mapping-with-ggplot2"><i class="fa fa-check"></i><b>3.1</b> Choropleth Mapping with <code>ggplot2</code></a></li>
<li class="chapter" data-level="3.2" data-path="mapping.html"><a href="mapping.html#raster-and-ggplot"><i class="fa fa-check"></i><b>3.2</b> Raster and ggplot</a></li>
<li class="chapter" data-level="3.3" data-path="mapping.html"><a href="mapping.html#choropleth-with-tmap"><i class="fa fa-check"></i><b>3.3</b> Choropleth with <code>tmap</code></a></li>
<li class="chapter" data-level="3.4" data-path="mapping.html"><a href="mapping.html#raster-with-tmap"><i class="fa fa-check"></i><b>3.4</b> Raster with <code>tmap</code></a></li>
<li class="chapter" data-level="3.5" data-path="mapping.html"><a href="mapping.html#web-mapping-with-leaflet"><i class="fa fa-check"></i><b>3.5</b> Web mapping with <code>leaflet</code></a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Using Spatial Data with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="intro" class="section level1 hasAnchor" number="1">
<h1><span class="header-section-number">Chapter 1</span> Introduction to spatial data in R<a href="intro.html#intro" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<blockquote>
<p>Learning Objectives</p>
<ul>
<li>Read table with geo coordinates into <code>sf</code> object</li>
<li>Read shapefiles into <code>sf</code> object</li>
<li>Examine <code>sf</code> objects</li>
<li>Use base plot with <code>sf</code> objects and attribute data</li>
<li>Read GeoTiff single and multiband into a <code>SpatRaster</code> object</li>
<li>Examine <code>SpatRaster</code> objects</li>
</ul>
</blockquote>
<hr />
<div id="the-sf-package" class="section level2 hasAnchor" number="1.1">
<h2><span class="header-section-number">1.1</span> The <code>sf</code> package<a href="intro.html#the-sf-package" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <a href="https://cran.r-project.org/package=sf"><code>sf</code></a><a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> package was first released on CRAN in late October 2016, and has in the mean time superseded the original R Package for storing and manipulating spatial data, <a href="https://CRAN.R-project.org/package=sp"><code>sp</code></a>, which was first released in 2005. <code>sp</code> is still actively maintained, but less often used now, so you should be aware of it, but we will not teach it here.</p>
<div class="figure"><span style="display:block;" id="fig:spsf-dl"></span>
<img src="img/spsf_downloads.png" alt="sf vs sp downloads on CRAN" width="100%" />
<p class="caption">
Figure 1.1: sf vs sp downloads on CRAN
</p>
</div>
<p><code>sf</code> implements a formal standard called <a href="https://en.wikipedia.org/wiki/Simple_Features">“Simple Features”</a> that specifies a storage and access model of spatial geometries (point, line, polygon). A feature geometry is called simple when it consists of points connected by straight line pieces, and does not intersect itself. This standard has been adopted widely, not only by spatial databases such as PostGIS, but also more recent standards such as GeoJSON.</p>
<p>If you work with PostGis or GeoJSON you may have come across the <a href="https://en.wikipedia.org/wiki/Well-known_text">WKT (well-known text)</a> format (Fig 1.1 and 1.2)</p>
<div class="figure"><span style="display:block;" id="fig:wkt-primitives"></span>
<img src="img/wkt_primitives.png" alt="Well-Known-Text Geometry primitives  (wikipedia)" width="100%" />
<p class="caption">
Figure 1.2: Well-Known-Text Geometry primitives (wikipedia)
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:wkt-multipart"></span>
<img src="img/wkt_multipart.png" alt="Well-Known-Text Multipart geometries (wikipedia)" width="100%" />
<p class="caption">
Figure 1.3: Well-Known-Text Multipart geometries (wikipedia)
</p>
</div>
<p><code>sf</code> implements this standard natively in R. In <code>sf</code> spatial objects are stored as a tabular format (data frame) with a special column that contains the information for the geometry coordinates. That special column holds a list with the same length as the number of rows in the data frame. Each of the individual list elements then can be of any length needed to hold the coordinates that correspond to an individual feature.</p>
<p><code>sf</code> objects are built up using the following structures:</p>
<ol style="list-style-type: decimal">
<li><code>sfg</code> - simple feature geometry (one feature)</li>
<li><code>sfc</code> - simple feature collection (a collection of <code>sfg</code>)</li>
<li><code>sf</code> - simple feature object (<code>sfc</code> with data attributes)</li>
</ol>
<p>So to create a spatial <code>sf</code> object manually the basic steps would be:</p>
<blockquote>
<p><strong>I. Create geometric objects (topology)</strong></p>
</blockquote>
<p>Geometric objects (simple features) can be created from a numeric vector, matrix or a list with the coordinates. They are called <code>sfg</code> objects for Simple Feature Geometry.b There are functions that help create simple feature geometries, like <code>st_point()</code>, <code>st_linestring()</code>, <code>st_polygon()</code> and more.</p>
<blockquote>
<p><strong>II. Combine all individual single feature objects for the special column.</strong></p>
</blockquote>
<p>The feature geometries are then combined into a Simple Feature Collection with <code>st_sfc()</code>. which is nothing other than a simple feature geometry list-column. The <code>sfc</code> object also holds the bounding box and the projection information.</p>
<blockquote>
<p><strong>III. Add attributes</strong>.</p>
</blockquote>
<p>Lastly, we add the attributes to the the simple feature collection with the <code>st_sf()</code> function. This function extends the well known data frame in R with a column that holds the simple feature collection.</p>
<p>To create a network of highways we would first generate LINESTRINGs as simple feature geometries out of a matrix with coordinates:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="intro.html#cb2-1" tabindex="-1"></a>lnstr_sfg1 <span class="ot">&lt;-</span> <span class="fu">st_linestring</span>(<span class="fu">matrix</span>(<span class="fu">runif</span>(<span class="dv">6</span>), <span class="at">ncol=</span><span class="dv">2</span>)) </span>
<span id="cb2-2"><a href="intro.html#cb2-2" tabindex="-1"></a>lnstr_sfg2 <span class="ot">&lt;-</span> <span class="fu">st_linestring</span>(<span class="fu">matrix</span>(<span class="fu">runif</span>(<span class="dv">6</span>), <span class="at">ncol=</span><span class="dv">2</span>)) </span>
<span id="cb2-3"><a href="intro.html#cb2-3" tabindex="-1"></a><span class="fu">class</span>(lnstr_sfg1)</span></code></pre></div>
<pre><code>#&gt; [1] &quot;XY&quot;         &quot;LINESTRING&quot; &quot;sfg&quot;</code></pre>
<p>We would then combine this into a simple feature collection :</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="intro.html#cb4-1" tabindex="-1"></a>(lnstr_sfc <span class="ot">&lt;-</span> <span class="fu">st_sfc</span>(lnstr_sfg1, lnstr_sfg2)) </span></code></pre></div>
<pre><code>#&gt; Geometry set for 2 features 
#&gt; Geometry type: LINESTRING
#&gt; Dimension:     XY
#&gt; Bounding box:  xmin: 0.05845885 ymin: 0.07983237 xmax: 0.9347772 ymax: 0.9139652
#&gt; CRS:           NA</code></pre>
<pre><code>#&gt; LINESTRING (0.1177288 0.3211188, 0.254328 0.862...</code></pre>
<pre><code>#&gt; LINESTRING (0.9347772 0.4617314, 0.5862836 0.07...</code></pre>
<p>And lastly create a data frame from above to generate the <code>sf</code> object:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="intro.html#cb8-1" tabindex="-1"></a>dfr <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">id =</span> <span class="fu">c</span>(<span class="st">&quot;hwy1&quot;</span>, <span class="st">&quot;hwy2&quot;</span>), </span>
<span id="cb8-2"><a href="intro.html#cb8-2" tabindex="-1"></a>                  <span class="at">cars_per_hour =</span> <span class="fu">c</span>(<span class="dv">78</span>, <span class="dv">22</span>))</span>
<span id="cb8-3"><a href="intro.html#cb8-3" tabindex="-1"></a>(lnstr_sf <span class="ot">&lt;-</span> <span class="fu">st_sf</span>(dfr , lnstr_sfc))</span></code></pre></div>
<pre><code>#&gt; Simple feature collection with 2 features and 2 fields
#&gt; Geometry type: LINESTRING
#&gt; Dimension:     XY
#&gt; Bounding box:  xmin: 0.05845885 ymin: 0.07983237 xmax: 0.9347772 ymax: 0.9139652
#&gt; CRS:           NA
#&gt;     id cars_per_hour                      lnstr_sfc
#&gt; 1 hwy1            78 LINESTRING (0.1177288 0.321...
#&gt; 2 hwy2            22 LINESTRING (0.9347772 0.461...</code></pre>
<p>There are many methods available in the <code>sf</code> package, to find out use</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="intro.html#cb10-1" tabindex="-1"></a><span class="fu">methods</span>(<span class="at">class=</span><span class="st">&quot;sf&quot;</span>)</span></code></pre></div>
<pre><code>#&gt;   [1] [                            [[&lt;-                        
#&gt;   [3] [&lt;-                          $&lt;-                         
#&gt;   [5] aggregate                    anti_join                   
#&gt;   [7] arrange                      as.data.frame               
#&gt;   [9] cbind                        coerce                      
#&gt;  [11] crs                          dbDataType                  
#&gt;  [13] dbWriteTable                 distance                    
#&gt;  [15] distinct                     dplyr_reconstruct           
#&gt;  [17] drop_na                      duplicated                  
#&gt;  [19] ext                          extract                     
#&gt;  [21] filter                       full_join                   
#&gt;  [23] gather                       group_by                    
#&gt;  [25] group_split                  identify                    
#&gt;  [27] initialize                   inner_join                  
#&gt;  [29] left_join                    lines                       
#&gt;  [31] mask                         merge                       
#&gt;  [33] mutate                       nest                        
#&gt;  [35] pivot_longer                 pivot_wider                 
#&gt;  [37] plot                         points                      
#&gt;  [39] polys                        print                       
#&gt;  [41] rasterize                    rbind                       
#&gt;  [43] rename_with                  rename                      
#&gt;  [45] right_join                   rowwise                     
#&gt;  [47] sample_frac                  sample_n                    
#&gt;  [49] select                       semi_join                   
#&gt;  [51] separate_rows                separate                    
#&gt;  [53] show                         slice                       
#&gt;  [55] slotsFromS3                  spread                      
#&gt;  [57] st_agr                       st_agr&lt;-                    
#&gt;  [59] st_area                      st_as_s2                    
#&gt;  [61] st_as_sf                     st_as_sfc                   
#&gt;  [63] st_bbox                      st_boundary                 
#&gt;  [65] st_break_antimeridian        st_buffer                   
#&gt;  [67] st_cast                      st_centroid                 
#&gt;  [69] st_collection_extract        st_concave_hull             
#&gt;  [71] st_convex_hull               st_coordinates              
#&gt;  [73] st_crop                      st_crs                      
#&gt;  [75] st_crs&lt;-                     st_difference               
#&gt;  [77] st_drop_geometry             st_filter                   
#&gt;  [79] st_geometry                  st_geometry&lt;-               
#&gt;  [81] st_inscribed_circle          st_interpolate_aw           
#&gt;  [83] st_intersection              st_intersects               
#&gt;  [85] st_is_valid                  st_is                       
#&gt;  [87] st_join                      st_line_merge               
#&gt;  [89] st_m_range                   st_make_valid               
#&gt;  [91] st_minimum_rotated_rectangle st_nearest_points           
#&gt;  [93] st_node                      st_normalize                
#&gt;  [95] st_point_on_surface          st_polygonize               
#&gt;  [97] st_precision                 st_reverse                  
#&gt;  [99] st_sample                    st_segmentize               
#&gt; [101] st_set_precision             st_shift_longitude          
#&gt; [103] st_simplify                  st_snap                     
#&gt; [105] st_sym_difference            st_transform                
#&gt; [107] st_triangulate_constrained   st_triangulate              
#&gt; [109] st_union                     st_voronoi                  
#&gt; [111] st_wrap_dateline             st_write                    
#&gt; [113] st_z_range                   st_zm                       
#&gt; [115] summarise                    svc                         
#&gt; [117] transform                    transmute                   
#&gt; [119] ungroup                      unite                       
#&gt; [121] unnest                       vect                        
#&gt; see &#39;?methods&#39; for accessing help and source code</code></pre>
<p>Here are some of the other highlights of <code>sf</code> you might be interested in:</p>
<ul>
<li>provides <strong>fast</strong> I/O, particularly relevant for large files</li>
<li>spatial functions that rely on GEOS and GDAL and PROJ external libraries are directly linked into the package, so no need to load additional external packages (like in <code>sp</code>)</li>
<li><code>sf</code> objects can be plotted directly with <code>ggplot</code></li>
<li><code>sf</code> directly reads from and writes to spatial <strong>databases</strong> such as PostGIS</li>
<li><code>sf</code> is compatible with the <a href="https://www.tidyverse.org/"><code>tidyvderse</code> approach</a>, (but see some <a href="https://geocompr.github.io/geocompkg/articles/tidyverse-pitfalls.html">pitfalls here</a>)</li>
</ul>
<p>Note that <code>sp</code> and <code>sf</code> are not the only way spatial objects are conceptualized in R. Other spatial packages may use their own class definitions for spatial data (for example <code>spatstat</code>).</p>
<p>There are packages specifically for the <a href="https://tools.ietf.org/html/rfc7946">GeoJSON</a> and for that reason are more lightweight, for example <a href="https://cran.r-project.org/package=geojson"><code>geojson</code></a></p>
<p>Usually you can find functions that convert objects to and from these formats.</p>
<blockquote>
<h3>
Challenge
</h3>
<p>Generate an <code>sf</code> point object.</p>
<ol style="list-style-type: decimal">
<li>Create a matrix <code>pts</code> of random numbers with two columns and as many rows as you like. These are your points.</li>
<li>Create a dataframe <code>attrib_df</code> with the same number of rows as your <code>pts</code> matrix and a column that holds an attribute. You can make up any attribute.</li>
<li>Use the appropriate commands and <code>pts</code> an <code>sf</code> object with a gemoetry column of class <code>sfc_POINT</code>.</li>
<li>Try to subset your spatial object using the attribute you have added and the way you are used to from regular data frames.</li>
<li>How do you determine the bounding box of your spatial object?</li>
</ol>
</blockquote>
</div>
<div id="creating-a-spatial-object-from-a-latlon-table" class="section level2 hasAnchor" number="1.2">
<h2><span class="header-section-number">1.2</span> Creating a spatial object from a lat/lon table<a href="intro.html#creating-a-spatial-object-from-a-latlon-table" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Often in your research might have a spreadsheet that contains latitude, longitude and perhaps some attribute values. You know how to read the spreadsheet into a tabular format (tibble) with <code>dplyr::read_table</code> or <code>dplyr::read_csv</code>. We can then very easily convert the table into a spatial object in R.</p>
<p>An <code>sf</code> object can be created from a data frame in the following way. We take advantage of the <code>st_as_sf()</code> function which converts any foreign object into an <code>sf</code> object. Similarly to above, it requires an argument <code>coords</code>, which in the case of point data needs to be a vector that specifies the data frame’s columns for the longitude and latitude (x,y) coordinates.</p>
<pre><code>my_sf_object &lt;- st_as_sf(myDataframe, coords)</code></pre>
<p><code>st_as_sf()</code> creates a new object and leaves the original data frame untouched.</p>
<p>We use <code>read_csv()</code> to read <code>philly_homicides.csv</code> into a tibble in R and name it <code>philly_homicides_df</code>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="intro.html#cb13-1" tabindex="-1"></a>philly_homicides_df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/philly_homicides.csv&quot;</span>)</span></code></pre></div>
<pre><code>#&gt; Rows: 3883 Columns: 10
#&gt; ── Column specification ────────────────────────────────────────────────────────
#&gt; Delimiter: &quot;,&quot;
#&gt; chr  (3): SECTOR, LOCATION_BLOCK, TEXT_GENERAL_CODE
#&gt; dbl  (5): DC_DIST, UCR_GENERAL, OBJ_ID, POINT_X, POINT_Y
#&gt; date (1): DISPATCH_DATE
#&gt; time (1): DISPATCH_TIME
#&gt; 
#&gt; ℹ Use `spec()` to retrieve the full column specification for this data.
#&gt; ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<p>We convert the <code>philly_homicides_df</code> data frame into an <code>sf</code> object with <code>st_as_sf()</code></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="intro.html#cb15-1" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb15-2"><a href="intro.html#cb15-2" tabindex="-1"></a></span>
<span id="cb15-3"><a href="intro.html#cb15-3" tabindex="-1"></a>philly_homicides_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(philly_homicides_df, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;POINT_X&quot;</span>, <span class="st">&quot;POINT_Y&quot;</span>))</span>
<span id="cb15-4"><a href="intro.html#cb15-4" tabindex="-1"></a><span class="fu">names</span>(philly_homicides_sf)</span></code></pre></div>
<pre><code>#&gt; [1] &quot;DC_DIST&quot;           &quot;SECTOR&quot;            &quot;DISPATCH_DATE&quot;    
#&gt; [4] &quot;DISPATCH_TIME&quot;     &quot;LOCATION_BLOCK&quot;    &quot;UCR_GENERAL&quot;      
#&gt; [7] &quot;OBJ_ID&quot;            &quot;TEXT_GENERAL_CODE&quot; &quot;geometry&quot;</code></pre>
<p>Note the additional <strong>geometry</strong> list-column which now holds the simple feature collection with the coordinates of all the points. We now use <code>st_crs()</code> to check on the projection.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="intro.html#cb17-1" tabindex="-1"></a><span class="fu">st_crs</span>(philly_homicides_sf)</span></code></pre></div>
<pre><code>#&gt; Coordinate Reference System: NA</code></pre>
<p>To make it a complete geographical object we use <code>st_crs()</code> to assign the WGS84 projection, which has the EPSG code 4326:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="intro.html#cb19-1" tabindex="-1"></a><span class="fu">st_crs</span>(philly_homicides_sf) <span class="ot">&lt;-</span> <span class="dv">4326</span></span>
<span id="cb19-2"><a href="intro.html#cb19-2" tabindex="-1"></a><span class="fu">st_crs</span>(philly_homicides_sf)</span></code></pre></div>
<pre><code>#&gt; Coordinate Reference System:
#&gt;   User input: EPSG:4326 
#&gt;   wkt:
#&gt; GEOGCRS[&quot;WGS 84&quot;,
#&gt;     ENSEMBLE[&quot;World Geodetic System 1984 ensemble&quot;,
#&gt;         MEMBER[&quot;World Geodetic System 1984 (Transit)&quot;],
#&gt;         MEMBER[&quot;World Geodetic System 1984 (G730)&quot;],
#&gt;         MEMBER[&quot;World Geodetic System 1984 (G873)&quot;],
#&gt;         MEMBER[&quot;World Geodetic System 1984 (G1150)&quot;],
#&gt;         MEMBER[&quot;World Geodetic System 1984 (G1674)&quot;],
#&gt;         MEMBER[&quot;World Geodetic System 1984 (G1762)&quot;],
#&gt;         MEMBER[&quot;World Geodetic System 1984 (G2139)&quot;],
#&gt;         ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,
#&gt;             LENGTHUNIT[&quot;metre&quot;,1]],
#&gt;         ENSEMBLEACCURACY[2.0]],
#&gt;     PRIMEM[&quot;Greenwich&quot;,0,
#&gt;         ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
#&gt;     CS[ellipsoidal,2],
#&gt;         AXIS[&quot;geodetic latitude (Lat)&quot;,north,
#&gt;             ORDER[1],
#&gt;             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
#&gt;         AXIS[&quot;geodetic longitude (Lon)&quot;,east,
#&gt;             ORDER[2],
#&gt;             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
#&gt;     USAGE[
#&gt;         SCOPE[&quot;Horizontal component of 3D system.&quot;],
#&gt;         AREA[&quot;World.&quot;],
#&gt;         BBOX[-90,-180,90,180]],
#&gt;     ID[&quot;EPSG&quot;,4326]]</code></pre>
<p>Wow this is long. It is usually more helpful to just retrieve the proj4string:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="intro.html#cb21-1" tabindex="-1"></a><span class="fu">st_crs</span>(philly_homicides_sf)<span class="sc">$</span>proj4string</span></code></pre></div>
<pre><code>#&gt; [1] &quot;+proj=longlat +datum=WGS84 +no_defs&quot;</code></pre>
<p>We will save this object as a shapefile on our hard drive for later use. (Note that by default <code>st_write</code> checks if the file already exists, and if so it will not overwrite it. If you need to force it to overwrite use the option <code>delete_layer = TRUE</code>.)</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="intro.html#cb23-1" tabindex="-1"></a><span class="fu">st_write</span>(philly_homicides_sf, <span class="st">&quot;data/PhillyHomicides&quot;</span>, <span class="at">driver =</span> <span class="st">&quot;ESRI Shapefile&quot;</span>)</span>
<span id="cb23-2"><a href="intro.html#cb23-2" tabindex="-1"></a><span class="co"># to force the save: </span></span>
<span id="cb23-3"><a href="intro.html#cb23-3" tabindex="-1"></a><span class="fu">st_write</span>(philly_homicides_sf, <span class="st">&quot;data/PhillyHomicides&quot;</span>, <span class="at">driver =</span> <span class="st">&quot;ESRI Shapefile&quot;</span>, <span class="at">delete_layer =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div id="loading-shape-files-into-r" class="section level2 hasAnchor" number="1.3">
<h2><span class="header-section-number">1.3</span> Loading shape files into R<a href="intro.html#loading-shape-files-into-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>sf</code> relies on the powerful <a href="http://gdal.org">GDAL library</a>, which is automatically linked in when loading <code>sf</code>. The GDAL provides the functionality to read and write spatial files of many formats. For shape files we can use <code>st_read()</code>, which simply takes the path of the directory with the shapefile as argument.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="intro.html#cb24-1" tabindex="-1"></a><span class="co"># read in</span></span>
<span id="cb24-2"><a href="intro.html#cb24-2" tabindex="-1"></a>philly_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&quot;data/Philly/&quot;</span>)</span></code></pre></div>
<pre><code>#&gt; Reading layer `PhillyTotalPopHHinc&#39; from data source 
#&gt;   `/Users/cengel/Anthro/R_Class/R_Workshops/R-spatial/data/Philly&#39; 
#&gt;   using driver `ESRI Shapefile&#39;
#&gt; Simple feature collection with 384 features and 17 fields
#&gt; Geometry type: MULTIPOLYGON
#&gt; Dimension:     XY
#&gt; Bounding box:  xmin: 1739497 ymin: 457343.7 xmax: 1764030 ymax: 490544.9
#&gt; Projected CRS: Albers</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="intro.html#cb26-1" tabindex="-1"></a><span class="co"># take a look at what we&#39;ve got</span></span>
<span id="cb26-2"><a href="intro.html#cb26-2" tabindex="-1"></a><span class="fu">str</span>(philly_sf) <span class="co"># note again the geometry column</span></span></code></pre></div>
<pre><code>#&gt; Classes &#39;sf&#39; and &#39;data.frame&#39;:   384 obs. of  18 variables:
#&gt;  $ STATEFP10 : chr  &quot;42&quot; &quot;42&quot; &quot;42&quot; &quot;42&quot; ...
#&gt;  $ COUNTYFP10: chr  &quot;101&quot; &quot;101&quot; &quot;101&quot; &quot;101&quot; ...
#&gt;  $ TRACTCE10 : chr  &quot;036301&quot; &quot;036400&quot; &quot;036600&quot; &quot;034803&quot; ...
#&gt;  $ GEOID10   : num  4.21e+10 4.21e+10 4.21e+10 4.21e+10 4.21e+10 ...
#&gt;  $ NAME10    : chr  &quot;363.01&quot; &quot;364&quot; &quot;366&quot; &quot;348.03&quot; ...
#&gt;  $ NAMELSAD10: chr  &quot;Census Tract 363.01&quot; &quot;Census Tract 364&quot; &quot;Census Tract 366&quot; &quot;Census Tract 348.03&quot; ...
#&gt;  $ MTFCC10   : chr  &quot;G5020&quot; &quot;G5020&quot; &quot;G5020&quot; &quot;G5020&quot; ...
#&gt;  $ FUNCSTAT10: chr  &quot;S&quot; &quot;S&quot; &quot;S&quot; &quot;S&quot; ...
#&gt;  $ ALAND10   : num  2322732 4501110 1004313 1271533 1016206 ...
#&gt;  $ AWATER10  : num  66075 8014 1426278 8021 0 ...
#&gt;  $ INTPTLAT10: chr  &quot;+40.0895349&quot; &quot;+40.1127747&quot; &quot;+39.9470272&quot; &quot;+40.0619427&quot; ...
#&gt;  $ INTPTLON10: chr  &quot;-074.9667387&quot; &quot;-074.9789137&quot; &quot;-075.1404472&quot; &quot;-075.0023705&quot; ...
#&gt;  $ GISJOIN   : chr  &quot;G4201010036301&quot; &quot;G4201010036400&quot; &quot;G4201010036600&quot; &quot;G4201010034803&quot; ...
#&gt;  $ Shape_area: num  2388806 4509124 2430591 1279556 1016207 ...
#&gt;  $ Shape_len : num  6851 10567 9257 4928 5920 ...
#&gt;  $ medHHinc  : num  54569 NA 130139 56667 69981 ...
#&gt;  $ totalPop  : num  3695 703 1643 4390 3807 ...
#&gt;  $ geometry  :sfc_MULTIPOLYGON of length 384; first list element: List of 1
#&gt;   ..$ :List of 1
#&gt;   .. ..$ : num [1:55, 1:2] 1763647 1763473 1763366 1763378 1763321 ...
#&gt;   ..- attr(*, &quot;class&quot;)= chr [1:3] &quot;XY&quot; &quot;MULTIPOLYGON&quot; &quot;sfg&quot;
#&gt;  - attr(*, &quot;sf_column&quot;)= chr &quot;geometry&quot;
#&gt;  - attr(*, &quot;agr&quot;)= Factor w/ 3 levels &quot;constant&quot;,&quot;aggregate&quot;,..: NA NA NA NA NA NA NA NA NA NA ...
#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:17] &quot;STATEFP10&quot; &quot;COUNTYFP10&quot; &quot;TRACTCE10&quot; &quot;GEOID10&quot; ...</code></pre>
<p>Two more words about the geometry column: Though it is not recommended, you can name this column any way you wish. Secondly, you can remove this column and revert to a regular, non-spatial data frame at any dime with <code>st_drop_geometry()</code>.</p>
<p>The default <code>plot</code> of an <code>sf</code> object is a multi-plot of the first attributes, with a warning if not all can be plotted:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="intro.html#cb28-1" tabindex="-1"></a><span class="fu">plot</span>(philly_sf)</span></code></pre></div>
<pre><code>#&gt; Warning: plotting the first 10 out of 17 attributes; use max.plot = 17 to plot
#&gt; all</code></pre>
<p><img src="R-spatial_files/figure-html/plot-shp-sf-1.png" width="672" /></p>
<p>In order to only plot the polygon boundaries we need to directly use the geometry column. We use the <code>st_geometry()</code> function. It extracts the <code>sfc</code> object (the simple feature geometry list column):</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="intro.html#cb30-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(philly_sf))</span></code></pre></div>
<p><img src="R-spatial_files/figure-html/plot-shp-sfg-1.png" width="672" /></p>
<p>Let’s add a subset of polygons with only the census tracts where the median houshold income (<em>medHHinc</em>) is more than $60,000. We can extract elements from an <code>sf</code> object based on attributes using the dplyr filter function (base R subsetting also works) and add the census tracts to the plot in a different color.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="intro.html#cb31-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(philly_sf))</span>
<span id="cb31-2"><a href="intro.html#cb31-2" tabindex="-1"></a>philly_sf <span class="sc">%&gt;%</span> </span>
<span id="cb31-3"><a href="intro.html#cb31-3" tabindex="-1"></a>  <span class="fu">filter</span>(medHHinc <span class="sc">&gt;</span> <span class="dv">60000</span>) <span class="sc">%&gt;%</span> <span class="co"># filter for high income</span></span>
<span id="cb31-4"><a href="intro.html#cb31-4" tabindex="-1"></a>  <span class="fu">st_geometry</span>() <span class="sc">%&gt;%</span> <span class="co"># extract the geometry for plotting</span></span>
<span id="cb31-5"><a href="intro.html#cb31-5" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">add=</span>T) <span class="co"># add to the plot</span></span></code></pre></div>
<p><img src="R-spatial_files/figure-html/pipe-subset-plot-shp-sfg-1.png" width="672" /></p>
</div>
<div id="raster-data-in-r" class="section level2 hasAnchor" number="1.4">
<h2><span class="header-section-number">1.4</span> Raster data in R<a href="intro.html#raster-data-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Raster files, as you might know, have a more compact data structure than vectors. Because of their regular structure the coordinates do not need to be recorded for each pixel or cell in the rectangular extent. A raster is defined by:</p>
<ul>
<li>a CRS</li>
<li>coordinates of its origin</li>
<li>a distance or cell size in each direction</li>
<li>a dimension or numbers of cells in each direction</li>
<li>an array of cell values</li>
</ul>
<p>Given this structure, coordinates for any cell can be computed and don’t need to be stored.</p>
<p><code>terra</code> was first released in 2020 and now replaces the <code>raster</code> package which was first released in 2010. <code>terra</code> has greater functionality, is faster and easier to use.</p>
<div class="figure"><span style="display:block;" id="fig:raster-terraDownloads"></span>
<img src="img/raster_terraDownloads.png" alt="raster vs terra downloads on CRAN" width="100%" />
<p class="caption">
Figure 1.4: raster vs terra downloads on CRAN
</p>
</div>
<p>The <code>terra</code> package has functions for creating, reading, manipulating, and writing raster data. The package also implements raster algebra and many other functions for raster data manipulation.</p>
<p>The package works with <code>SpatRaster</code> objects. The <code>rast()</code> function is used to create these objects. For example, to create a raster object from scratch we would do the following:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="intro.html#cb32-1" tabindex="-1"></a><span class="fu">library</span>(terra)</span>
<span id="cb32-2"><a href="intro.html#cb32-2" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">rast</span>(<span class="at">nrows=</span><span class="dv">20</span>, <span class="at">ncols=</span><span class="dv">20</span>, <span class="co"># number of cells in x and y dimension</span></span>
<span id="cb32-3"><a href="intro.html#cb32-3" tabindex="-1"></a>          <span class="at">xmin=</span><span class="dv">0</span>, <span class="at">xmax=</span><span class="dv">360</span>) <span class="co"># min and max x coordinates (left-right borders)</span></span>
<span id="cb32-4"><a href="intro.html#cb32-4" tabindex="-1"></a>r</span></code></pre></div>
<pre><code>#&gt; class       : SpatRaster 
#&gt; dimensions  : 20, 20, 1  (nrow, ncol, nlyr)
#&gt; resolution  : 18, 9  (x, y)
#&gt; extent      : 0, 360, -90, 90  (xmin, xmax, ymin, ymax)
#&gt; coord. ref. : lon/lat WGS 84</code></pre>
<p>From the output above we know that:</p>
<ul>
<li>the object is of class <code>SpatRaster</code></li>
<li>its dimensions are 20x20 cells</li>
<li>it has one layer (band)</li>
<li>the extent of the raster</li>
<li>it <strong>has a CRS defined!</strong> If the crs argument is missing when creating the SpatRaster object, if the x coordinates are within -360 and 360 and the y coordinates are within -90 and 90, the WGS84 projection is used by default.</li>
</ul>
<p>Good to know.</p>
<p>There are functions to look at individual properties of the raster object. For examle for the number of cells:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="intro.html#cb34-1" tabindex="-1"></a><span class="fu">ncell</span>(r)</span></code></pre></div>
<pre><code>#&gt; [1] 400</code></pre>
<p>Or we can retrieve just the number of bands using the <code>nlyr()</code> function.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="intro.html#cb36-1" tabindex="-1"></a><span class="fu">nlyr</span>(r)</span></code></pre></div>
<pre><code>#&gt; [1] 1</code></pre>
<p>We can also find out about the Coordinate Reference System (CRS) with the <code>crs</code> function. The default output looks a little messy:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="intro.html#cb38-1" tabindex="-1"></a><span class="fu">crs</span>(r)</span></code></pre></div>
<pre><code>#&gt; [1] &quot;GEOGCRS[\&quot;WGS 84\&quot;,\n    DATUM[\&quot;World Geodetic System 1984\&quot;,\n        ELLIPSOID[\&quot;WGS 84\&quot;,6378137,298.257223563,\n            LENGTHUNIT[\&quot;metre\&quot;,1]],\n        ID[\&quot;EPSG\&quot;,6326]],\n    PRIMEM[\&quot;Greenwich\&quot;,0,\n        ANGLEUNIT[\&quot;degree\&quot;,0.0174532925199433],\n        ID[\&quot;EPSG\&quot;,8901]],\n    CS[ellipsoidal,2],\n        AXIS[\&quot;longitude\&quot;,east,\n            ORDER[1],\n            ANGLEUNIT[\&quot;degree\&quot;,0.0174532925199433,\n                ID[\&quot;EPSG\&quot;,9122]]],\n        AXIS[\&quot;latitude\&quot;,north,\n            ORDER[2],\n            ANGLEUNIT[\&quot;degree\&quot;,0.0174532925199433,\n                ID[\&quot;EPSG\&quot;,9122]]]]&quot;</code></pre>
<p>We can make this easier to read by setting the proj argument:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="intro.html#cb40-1" tabindex="-1"></a><span class="fu">crs</span>(r, <span class="at">proj =</span> <span class="cn">TRUE</span>) <span class="co"># return the PROJ-string notation</span></span></code></pre></div>
<pre><code>#&gt; [1] &quot;+proj=longlat +datum=WGS84 +no_defs&quot;</code></pre>
<p>Let’s try and plot this.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="intro.html#cb42-1" tabindex="-1"></a><span class="fu">plot</span>(r)</span></code></pre></div>
<p>The canvas is empty! This is because even though we have a layer, the cells do not have any values.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="intro.html#cb43-1" tabindex="-1"></a><span class="fu">values</span>(r)</span></code></pre></div>
<p>To add some random values to the cells we can take advantage of the <code>ncells()</code> function and do this:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="intro.html#cb44-1" tabindex="-1"></a><span class="fu">values</span>(r) <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">ncell</span>(r))</span>
<span id="cb44-2"><a href="intro.html#cb44-2" tabindex="-1"></a>r </span></code></pre></div>
<pre><code>#&gt; class       : SpatRaster 
#&gt; dimensions  : 20, 20, 1  (nrow, ncol, nlyr)
#&gt; resolution  : 18, 9  (x, y)
#&gt; extent      : 0, 360, -90, 90  (xmin, xmax, ymin, ymax)
#&gt; coord. ref. : lon/lat WGS 84 
#&gt; source(s)   : memory
#&gt; name        :       lyr.1 
#&gt; min value   : 0.005382989 
#&gt; max value   : 0.999929903</code></pre>
<p>In addition to the output above, we now see:</p>
<ul>
<li>the source, which indicates where the cell values are stored (here they are in memory)</li>
<li>the range of the cell values (min value adn max value) now added.</li>
<li>the name, of the layer which is by default lyr.1.</li>
</ul>
<p>This now plots successfully:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="intro.html#cb46-1" tabindex="-1"></a><span class="fu">plot</span>(r)</span></code></pre></div>
<p><img src="R-spatial_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>(The <a href="https://cran.r-project.org/web/packages/rasterVis/index.html"><code>rasterVis</code> package</a> provides a set of methods for enhanced visualization and interaction for more advanced plotting of raster objects.)</p>
<p><code>SpatRaster</code> objects can also be created from a matrix.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="intro.html#cb47-1" tabindex="-1"></a><span class="fu">class</span>(volcano)</span></code></pre></div>
<pre><code>#&gt; [1] &quot;matrix&quot; &quot;array&quot;</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="intro.html#cb49-1" tabindex="-1"></a>volcano.r <span class="ot">&lt;-</span> <span class="fu">rast</span>(volcano)</span>
<span id="cb49-2"><a href="intro.html#cb49-2" tabindex="-1"></a><span class="fu">class</span>(volcano.r)</span></code></pre></div>
<pre><code>#&gt; [1] &quot;SpatRaster&quot;
#&gt; attr(,&quot;package&quot;)
#&gt; [1] &quot;terra&quot;</code></pre>
<p>We also use the <code>rast()</code> function to read in a raster file. This raster is generated as part of the <a href="https://www.neonscience.org/field-sites/field-sites-map/HARV">NEON Harvard Forest field site</a>.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="intro.html#cb51-1" tabindex="-1"></a>HARV <span class="ot">&lt;-</span> <span class="fu">rast</span>(<span class="st">&quot;data/HARV_RGB_Ortho.tif&quot;</span>)</span></code></pre></div>
<p>Typing the name of the object will give us what’s in there:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="intro.html#cb52-1" tabindex="-1"></a>HARV</span></code></pre></div>
<pre><code>#&gt; class       : SpatRaster 
#&gt; dimensions  : 2317, 3073, 3  (nrow, ncol, nlyr)
#&gt; resolution  : 0.25, 0.25  (x, y)
#&gt; extent      : 731998.5, 732766.8, 4712956, 4713536  (xmin, xmax, ymin, ymax)
#&gt; coord. ref. : WGS 84 / UTM zone 18N (EPSG:32618) 
#&gt; source      : HARV_RGB_Ortho.tif 
#&gt; names       : HARV_RGB_Ortho_1, HARV_RGB_Ortho_2, HARV_RGB_Ortho_3 
#&gt; min values  :                0,                0,                0 
#&gt; max values  :              255,              255,              255</code></pre>
<blockquote>
<h3>
Challenge
</h3>
<p>Based on the output above answer the following questions:</p>
<ol style="list-style-type: decimal">
<li>How many bands?</li>
<li>What are the names of the bands)?</li>
<li>Where are the cell values stored?</li>
<li>What is the CRS?</li>
</ol>
</blockquote>
<p>We can plot the object like this:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="intro.html#cb54-1" tabindex="-1"></a><span class="fu">plot</span>(HARV)</span></code></pre></div>
<p><img src="R-spatial_files/figure-html/plot-raster-1.png" width="672" /></p>
<p>Or to plot a single band:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="intro.html#cb55-1" tabindex="-1"></a><span class="fu">plot</span>(HARV, <span class="dv">3</span>)</span></code></pre></div>
<p><img src="R-spatial_files/figure-html/plot-raster-single-1.png" width="672" /></p>
<p>We can also use the <code>rast()</code> function to import one single band:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="intro.html#cb56-1" tabindex="-1"></a>HARV_Band2 <span class="ot">&lt;-</span> <span class="fu">rast</span>(<span class="st">&quot;data/HARV_RGB_Ortho.tif&quot;</span>, <span class="at">lyrs =</span> <span class="dv">2</span>)</span>
<span id="cb56-2"><a href="intro.html#cb56-2" tabindex="-1"></a><span class="fu">plot</span>(HARV_Band2)</span></code></pre></div>
<p><img src="R-spatial_files/figure-html/one-multiband-1.png" width="672" /></p>
<p>Let’s now explore the distribution of values contained within our raster using the <code>hist()</code> function which produces a histogram. Histograms are often useful in identifying outliers and bad data values in our raster data.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="intro.html#cb57-1" tabindex="-1"></a><span class="fu">hist</span>(HARV)</span></code></pre></div>
<pre><code>#&gt; Warning: [hist] a sample of 14% of the cells was used

#&gt; Warning: [hist] a sample of 14% of the cells was used

#&gt; Warning: [hist] a sample of 14% of the cells was used</code></pre>
<p><img src="R-spatial_files/figure-html/n-hist-1.png" width="672" /></p>
<p>Notice that a warning message is produced when R creates the histogram. By default the maximum cells processed per band is 1,000,000. This maximum value is to ensure processing efficiency as our data become larger. We can force the <code>hist</code> function to use all cell values.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="intro.html#cb59-1" tabindex="-1"></a><span class="fu">ncell</span>(HARV)</span></code></pre></div>
<pre><code>#&gt; [1] 7120141</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="intro.html#cb61-1" tabindex="-1"></a><span class="fu">hist</span>(HARV, <span class="at">maxcell =</span> <span class="fu">ncell</span>(HARV))</span></code></pre></div>
<p><img src="R-spatial_files/figure-html/n-hist-allvals-1.png" width="672" /></p>
<p>At times it may be useful to explore raster metadata before loading them into R. This can be done with the function <code>describe()</code></p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="intro.html#cb62-1" tabindex="-1"></a><span class="fu">describe</span>(<span class="st">&quot;data/HARV_RGB_Ortho.tif&quot;</span>)</span></code></pre></div>
<pre><code>#&gt;  [1] &quot;Driver: GTiff/GeoTIFF&quot;                                                                                                                                                                                                                                                          
#&gt;  [2] &quot;Files: data/HARV_RGB_Ortho.tif&quot;                                                                                                                                                                                                                                                 
#&gt;  [3] &quot;Size is 3073, 2317&quot;                                                                                                                                                                                                                                                             
#&gt;  [4] &quot;Coordinate System is:&quot;                                                                                                                                                                                                                                                          
#&gt;  [5] &quot;PROJCRS[\&quot;WGS 84 / UTM zone 18N\&quot;,&quot;                                                                                                                                                                                                                                             
#&gt;  [6] &quot;    BASEGEOGCRS[\&quot;WGS 84\&quot;,&quot;                                                                                                                                                                                                                                                    
#&gt;  [7] &quot;        DATUM[\&quot;World Geodetic System 1984\&quot;,&quot;                                                                                                                                                                                                                                  
#&gt;  [8] &quot;            ELLIPSOID[\&quot;WGS 84\&quot;,6378137,298.257223563,&quot;                                                                                                                                                                                                                        
#&gt;  [9] &quot;                LENGTHUNIT[\&quot;metre\&quot;,1]]],&quot;                                                                                                                                                                                                                                     
#&gt; [10] &quot;        PRIMEM[\&quot;Greenwich\&quot;,0,&quot;                                                                                                                                                                                                                                                
#&gt; [11] &quot;            ANGLEUNIT[\&quot;degree\&quot;,0.0174532925199433]],&quot;                                                                                                                                                                                                                         
#&gt; [12] &quot;        ID[\&quot;EPSG\&quot;,4326]],&quot;                                                                                                                                                                                                                                                    
#&gt; [13] &quot;    CONVERSION[\&quot;UTM zone 18N\&quot;,&quot;                                                                                                                                                                                                                                               
#&gt; [14] &quot;        METHOD[\&quot;Transverse Mercator\&quot;,&quot;                                                                                                                                                                                                                                        
#&gt; [15] &quot;            ID[\&quot;EPSG\&quot;,9807]],&quot;                                                                                                                                                                                                                                                
#&gt; [16] &quot;        PARAMETER[\&quot;Latitude of natural origin\&quot;,0,&quot;                                                                                                                                                                                                                            
#&gt; [17] &quot;            ANGLEUNIT[\&quot;degree\&quot;,0.0174532925199433],&quot;                                                                                                                                                                                                                          
#&gt; [18] &quot;            ID[\&quot;EPSG\&quot;,8801]],&quot;                                                                                                                                                                                                                                                
#&gt; [19] &quot;        PARAMETER[\&quot;Longitude of natural origin\&quot;,-75,&quot;                                                                                                                                                                                                                         
#&gt; [20] &quot;            ANGLEUNIT[\&quot;degree\&quot;,0.0174532925199433],&quot;                                                                                                                                                                                                                          
#&gt; [21] &quot;            ID[\&quot;EPSG\&quot;,8802]],&quot;                                                                                                                                                                                                                                                
#&gt; [22] &quot;        PARAMETER[\&quot;Scale factor at natural origin\&quot;,0.9996,&quot;                                                                                                                                                                                                                   
#&gt; [23] &quot;            SCALEUNIT[\&quot;unity\&quot;,1],&quot;                                                                                                                                                                                                                                            
#&gt; [24] &quot;            ID[\&quot;EPSG\&quot;,8805]],&quot;                                                                                                                                                                                                                                                
#&gt; [25] &quot;        PARAMETER[\&quot;False easting\&quot;,500000,&quot;                                                                                                                                                                                                                                    
#&gt; [26] &quot;            LENGTHUNIT[\&quot;metre\&quot;,1],&quot;                                                                                                                                                                                                                                           
#&gt; [27] &quot;            ID[\&quot;EPSG\&quot;,8806]],&quot;                                                                                                                                                                                                                                                
#&gt; [28] &quot;        PARAMETER[\&quot;False northing\&quot;,0,&quot;                                                                                                                                                                                                                                        
#&gt; [29] &quot;            LENGTHUNIT[\&quot;metre\&quot;,1],&quot;                                                                                                                                                                                                                                           
#&gt; [30] &quot;            ID[\&quot;EPSG\&quot;,8807]]],&quot;                                                                                                                                                                                                                                               
#&gt; [31] &quot;    CS[Cartesian,2],&quot;                                                                                                                                                                                                                                                           
#&gt; [32] &quot;        AXIS[\&quot;(E)\&quot;,east,&quot;                                                                                                                                                                                                                                                     
#&gt; [33] &quot;            ORDER[1],&quot;                                                                                                                                                                                                                                                          
#&gt; [34] &quot;            LENGTHUNIT[\&quot;metre\&quot;,1]],&quot;                                                                                                                                                                                                                                          
#&gt; [35] &quot;        AXIS[\&quot;(N)\&quot;,north,&quot;                                                                                                                                                                                                                                                    
#&gt; [36] &quot;            ORDER[2],&quot;                                                                                                                                                                                                                                                          
#&gt; [37] &quot;            LENGTHUNIT[\&quot;metre\&quot;,1]],&quot;                                                                                                                                                                                                                                          
#&gt; [38] &quot;    USAGE[&quot;                                                                                                                                                                                                                                                                     
#&gt; [39] &quot;        SCOPE[\&quot;Engineering survey, topographic mapping.\&quot;],&quot;                                                                                                                                                                                                                   
#&gt; [40] &quot;        AREA[\&quot;Between 78°W and 72°W, northern hemisphere between equator and 84°N, onshore and offshore. Bahamas. Canada - Nunavut; Ontario; Quebec. Colombia. Cuba. Ecuador. Greenland. Haiti. Jamaica. Panama. Turks and Caicos Islands. United States (USA). Venezuela.\&quot;],&quot;
#&gt; [41] &quot;        BBOX[0,-78,84,-72]],&quot;                                                                                                                                                                                                                                                   
#&gt; [42] &quot;    ID[\&quot;EPSG\&quot;,32618]]&quot;                                                                                                                                                                                                                                                        
#&gt; [43] &quot;Data axis to CRS axis mapping: 1,2&quot;                                                                                                                                                                                                                                             
#&gt; [44] &quot;Origin = (731998.500000000000000,4713535.500000000000000)&quot;                                                                                                                                                                                                                      
#&gt; [45] &quot;Pixel Size = (0.250000000000000,-0.250000000000000)&quot;                                                                                                                                                                                                                            
#&gt; [46] &quot;Metadata:&quot;                                                                                                                                                                                                                                                                      
#&gt; [47] &quot;  AREA_OR_POINT=Area&quot;                                                                                                                                                                                                                                                           
#&gt; [48] &quot;Image Structure Metadata:&quot;                                                                                                                                                                                                                                                      
#&gt; [49] &quot;  COMPRESSION=LZW&quot;                                                                                                                                                                                                                                                              
#&gt; [50] &quot;  INTERLEAVE=PIXEL&quot;                                                                                                                                                                                                                                                             
#&gt; [51] &quot;Corner Coordinates:&quot;                                                                                                                                                                                                                                                            
#&gt; [52] &quot;Upper Left  (  731998.500, 4713535.500) ( 72d10&#39;29.27\&quot;W, 42d32&#39;21.80\&quot;N)&quot;                                                                                                                                                                                                      
#&gt; [53] &quot;Lower Left  (  731998.500, 4712956.250) ( 72d10&#39;30.11\&quot;W, 42d32&#39; 3.04\&quot;N)&quot;                                                                                                                                                                                                      
#&gt; [54] &quot;Upper Right (  732766.750, 4713535.500) ( 72d 9&#39;55.63\&quot;W, 42d32&#39;20.97\&quot;N)&quot;                                                                                                                                                                                                      
#&gt; [55] &quot;Lower Right (  732766.750, 4712956.250) ( 72d 9&#39;56.48\&quot;W, 42d32&#39; 2.21\&quot;N)&quot;                                                                                                                                                                                                      
#&gt; [56] &quot;Center      (  732382.625, 4713245.875) ( 72d10&#39;12.87\&quot;W, 42d32&#39;12.00\&quot;N)&quot;                                                                                                                                                                                                      
#&gt; [57] &quot;Band 1 Block=3073x1 Type=Float64, ColorInterp=Gray&quot;                                                                                                                                                                                                                             
#&gt; [58] &quot;  Min=0.000 Max=255.000 &quot;                                                                                                                                                                                                                                                       
#&gt; [59] &quot;  Minimum=0.000, Maximum=255.000, Mean=nan, StdDev=nan&quot;                                                                                                                                                                                                                         
#&gt; [60] &quot;  NoData Value=-1.7e+308&quot;                                                                                                                                                                                                                                                       
#&gt; [61] &quot;  Metadata:&quot;                                                                                                                                                                                                                                                                    
#&gt; [62] &quot;    STATISTICS_MAXIMUM=255&quot;                                                                                                                                                                                                                                                     
#&gt; [63] &quot;    STATISTICS_MEAN=nan&quot;                                                                                                                                                                                                                                                        
#&gt; [64] &quot;    STATISTICS_MINIMUM=0&quot;                                                                                                                                                                                                                                                       
#&gt; [65] &quot;    STATISTICS_STDDEV=nan&quot;                                                                                                                                                                                                                                                      
#&gt; [66] &quot;Band 2 Block=3073x1 Type=Float64, ColorInterp=Undefined&quot;                                                                                                                                                                                                                        
#&gt; [67] &quot;  Min=0.000 Max=255.000 &quot;                                                                                                                                                                                                                                                       
#&gt; [68] &quot;  Minimum=0.000, Maximum=255.000, Mean=nan, StdDev=nan&quot;                                                                                                                                                                                                                         
#&gt; [69] &quot;  NoData Value=-1.7e+308&quot;                                                                                                                                                                                                                                                       
#&gt; [70] &quot;  Metadata:&quot;                                                                                                                                                                                                                                                                    
#&gt; [71] &quot;    STATISTICS_MAXIMUM=255&quot;                                                                                                                                                                                                                                                     
#&gt; [72] &quot;    STATISTICS_MEAN=nan&quot;                                                                                                                                                                                                                                                        
#&gt; [73] &quot;    STATISTICS_MINIMUM=0&quot;                                                                                                                                                                                                                                                       
#&gt; [74] &quot;    STATISTICS_STDDEV=nan&quot;                                                                                                                                                                                                                                                      
#&gt; [75] &quot;Band 3 Block=3073x1 Type=Float64, ColorInterp=Undefined&quot;                                                                                                                                                                                                                        
#&gt; [76] &quot;  Min=0.000 Max=255.000 &quot;                                                                                                                                                                                                                                                       
#&gt; [77] &quot;  Minimum=0.000, Maximum=255.000, Mean=nan, StdDev=nan&quot;                                                                                                                                                                                                                         
#&gt; [78] &quot;  NoData Value=-1.7e+308&quot;                                                                                                                                                                                                                                                       
#&gt; [79] &quot;  Metadata:&quot;                                                                                                                                                                                                                                                                    
#&gt; [80] &quot;    STATISTICS_MAXIMUM=255&quot;                                                                                                                                                                                                                                                     
#&gt; [81] &quot;    STATISTICS_MEAN=nan&quot;                                                                                                                                                                                                                                                        
#&gt; [82] &quot;    STATISTICS_MINIMUM=0&quot;                                                                                                                                                                                                                                                       
#&gt; [83] &quot;    STATISTICS_STDDEV=nan&quot;</code></pre>
<p>For the many functions available for working with such an object see:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="intro.html#cb64-1" tabindex="-1"></a><span class="fu">methods</span>(<span class="at">class=</span><span class="st">&quot;SpatRaster&quot;</span>)</span></code></pre></div>
<pre><code>#&gt;   [1] !                     [                     [[                   
#&gt;   [4] [[&lt;-                  [&lt;-                   %in%                 
#&gt;   [7] $                     $&lt;-                   activeCat            
#&gt;  [10] activeCat&lt;-           add&lt;-                 addCats              
#&gt;  [13] adjacent              aggregate             align                
#&gt;  [16] all.equal             allNA                 animate              
#&gt;  [19] anyNA                 app                   approximate          
#&gt;  [22] area                  Arith                 as.array             
#&gt;  [25] as.bool               as.character          as.contour           
#&gt;  [28] as.data.frame         as.factor             as.int               
#&gt;  [31] as.integer            as.lines              as.list              
#&gt;  [34] as.logical            as.matrix             as.numeric           
#&gt;  [37] as.points             as.polygons           as.raster            
#&gt;  [40] atan_2                atan2                 autocor              
#&gt;  [43] barplot               blocks                boundaries           
#&gt;  [46] boxplot               buffer                c                    
#&gt;  [49] catalyze              categories            cats                 
#&gt;  [52] cellFromRowCol        cellFromRowColCombine cellFromXY           
#&gt;  [55] cells                 cellSize              clamp_ts             
#&gt;  [58] clamp                 classify              click                
#&gt;  [61] coerce                colFromCell           colFromX             
#&gt;  [64] colorize              coltab                coltab&lt;-             
#&gt;  [67] Compare               compare               compareGeom          
#&gt;  [70] concats               contour               costDist             
#&gt;  [73] countNA               cover                 crds                 
#&gt;  [76] crop                  crosstab              crs                  
#&gt;  [79] crs&lt;-                 datatype              deepcopy             
#&gt;  [82] density               depth                 depth&lt;-              
#&gt;  [85] diff                  dim                   dim&lt;-                
#&gt;  [88] direction             disagg                distance             
#&gt;  [91] droplevels            expanse               ext                  
#&gt;  [94] ext&lt;-                 extend                extract              
#&gt;  [97] extractRange          fillTime              flip                 
#&gt; [100] focal                 focal3D               focalCor             
#&gt; [103] focalCpp              focalPairs            focalReg             
#&gt; [106] focalValues           freq                  getTileExtents       
#&gt; [109] global                gridDist              gridDistance         
#&gt; [112] has.colors            has.RGB               has.time             
#&gt; [115] hasMinMax             hasValues             head                 
#&gt; [118] hist                  identical             ifel                 
#&gt; [121] image                 init                  inMemory             
#&gt; [124] inset                 interpIDW             interpNear           
#&gt; [127] interpolate           intersect             is.bool              
#&gt; [130] is.factor             is.finite             is.infinite          
#&gt; [133] is.int                is.lonlat             is.na                
#&gt; [136] is.nan                is.related            is.rotated           
#&gt; [139] isFALSE               isTRUE                k_means              
#&gt; [142] lapp                  layerCor              levels               
#&gt; [145] levels&lt;-              linearUnits           lines                
#&gt; [148] log                   Logic                 logic                
#&gt; [151] longnames             longnames&lt;-           makeTiles            
#&gt; [154] mask                  match                 math                 
#&gt; [157] Math                  Math2                 mean                 
#&gt; [160] median                merge                 meta                 
#&gt; [163] metags                metags&lt;-              minmax               
#&gt; [166] modal                 mosaic                NAflag               
#&gt; [169] NAflag&lt;-              names                 names&lt;-              
#&gt; [172] ncell                 ncol                  ncol&lt;-               
#&gt; [175] nlyr                  nlyr&lt;-                noNA                 
#&gt; [178] not.na                nrow                  nrow&lt;-               
#&gt; [181] nsrc                  origin                origin&lt;-             
#&gt; [184] pairs                 panel                 patches              
#&gt; [187] persp                 plet                  plot                 
#&gt; [190] plotRGB               points                polys                
#&gt; [193] prcomp                predict               princomp             
#&gt; [196] project               quantile              rangeFill            
#&gt; [199] rapp                  rast                  rasterize            
#&gt; [202] rasterizeGeom         rasterizeWin          rcl                  
#&gt; [205] readStart             readStop              readValues           
#&gt; [208] rectify               regress               relate               
#&gt; [211] rep                   res                   res&lt;-                
#&gt; [214] resample              rescale               rev                  
#&gt; [217] RGB                   RGB&lt;-                 roll                 
#&gt; [220] rotate                rowColCombine         rowColFromCell       
#&gt; [223] rowFromCell           rowFromY              sapp                 
#&gt; [226] saveRDS               scale                 scoff                
#&gt; [229] scoff&lt;-               sds                   segregate            
#&gt; [232] sel                   selectHighest         selectRange          
#&gt; [235] serialize             set.cats              set.crs              
#&gt; [238] set.ext               set.names             set.RGB              
#&gt; [241] set.values            setMinMax             setValues            
#&gt; [244] shift                 show                  sieve                
#&gt; [247] size                  sort                  sources              
#&gt; [250] spatSample            split                 sprc                 
#&gt; [253] st_bbox               st_crs                stdev                
#&gt; [256] str                   stretch               subset               
#&gt; [259] subst                 summary               Summary              
#&gt; [262] t                     tail                  tapp                 
#&gt; [265] terrain               text                  tighten              
#&gt; [268] time                  time&lt;-                timeInfo             
#&gt; [271] trans                 trim                  unique               
#&gt; [274] units                 units&lt;-               update               
#&gt; [277] values                values&lt;-              varnames             
#&gt; [280] varnames&lt;-            viewshed              weighted.mean        
#&gt; [283] where.max             where.min             which.lyr            
#&gt; [286] which.max             which.min             window               
#&gt; [289] window&lt;-              wrap                  wrapCache            
#&gt; [292] writeCDF              writeRaster           writeStart           
#&gt; [295] writeStop             writeValues           xapp                 
#&gt; [298] xFromCell             xFromCol              xmax                 
#&gt; [301] xmax&lt;-                xmin                  xmin&lt;-               
#&gt; [304] xres                  xyFromCell            yFromCell            
#&gt; [307] yFromRow              ymax                  ymax&lt;-               
#&gt; [310] ymin                  ymin&lt;-                yres                 
#&gt; [313] zonal                 zoom                 
#&gt; see &#39;?methods&#39; for accessing help and source code</code></pre>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>E. Pebesma &amp; R. Bivand (2016)<a href="http://pebesma.staff.ifgi.de/pebesma_sfr.pdf">Spatial data in R: simple features and
future perspectives</a><a href="intro.html#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="spatialops.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/cengel/R-spatial/edit/master/01-spatial-data.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["R-spatial.pdf", "R-spatial.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
